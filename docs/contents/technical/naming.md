# 名づける

## 名は体をあらす

「名は体を表す」とは、「物や人の名前は、その本質や実体をよく表している」という意味のことわざです。
つまり、名前とその実体は一致するという考え方です。

この言葉の由来は仏教の概念「名体不二（みょうたいふに）」にあるそうです。
これは、 **「名前とその本質は切り離せない」** という教えで、特に阿弥陀仏の名号がそのまま阿弥陀仏の本体の功徳を表しているという考え方に基づいているそうです。

特に、日本人はこのような考え方が、心の奥底にしみついています。
その名前から受ける印象が、さも本質であるかのように感じ取ることが多いようです。
ソースコードを読むときも同じであると、筆者は感じています。
読みやすいコードは、名前にこだわりを感じます。
意識的にわかりやすい名前をつけるように心がけましょう。
ここでは、ソースコードに現れる名づけについて考察していきます。

## 名づけの自由度

ソースコードを記述する場合、以下のような **名前** はプログラマが自由に定義できます。

* メソッド名 (関数名)
* プロパティ名 (変数名)
* ユーザ定義クラスやインタフェース名 (型名)

これらの **名前** は、まさに「名は体をあらわす」ように名づけたほうが、圧倒的に読みやすくなります。

例えば、下記のようなコードを見てみよう。

```typescript
const flg:boolean = (someValue % 2) === 1;
// ...
if (flg) {
    // someValueが奇数だった場合
}
```

このときコメント文の `// someValueが奇数だった場合` が無かったら、`flg` が何を意味するかわからないです。
そこで、次のように書けばどうでしょうか。

```typescript
const someValueIsOdd:boolean = (someValue % 2) === 1;
// ...
if (someValueIsOdd) {
    // ...
}
```

`Odd` が奇数であるということがわかれば、明らかに「`someValue`が奇数だった場合」ということがわかります。
このように、「名前付け」が「よみさすさ」に大きく影響を及ぼします。

## よくあるアンチパターン

まず、どうすれば「よみやすくなるか」を示す前に、「よみにくくなる」例(アンチパターン)をいくつか示します。

### <i class="fa-solid fa-shuffle"></i> 適当な名前付け

筆者は小学生のとき、初めてロールプレイングゲームを遊んだ。
当時はインターネットもなく、ロールプレイングゲームがいったいどういうものかもわからず遊び始めたのを覚えている。
ゲームを初めてすぐに、「なまえをにゅうりょくしてください」といわれました。
急に言われてもいい名前を思いつかず、かといって自分の名前を入れるのもなんだか恥ずかしい気持ちになったので、**適当に「ああああ」と入力して** ゲームを開始してしまった。

![適当な名前](../../assets/img/yusha.png)

当然のことながら、ゲーム内で、「むらびと」や「おおさま」が私のことを「ああああ」と呼び始めます。
**ラスボスまで、主人公のことを「ああああ」呼ぶ始末**。
ストーリーが全く頭に入らず、とても苦い経験をしました。
それ以降、ロールプレイングゲームを始める前に、そのパッケージからそのゲームの世界観を想像し、いろんな漫画やアニメから着想を得て、名前をつけるようになりました。

プログラミングも同様です。ソースコードに「読んでもらいたい」という気持ちを込めて名前をつけましょう。
以下に避けるべき名前のつけ方を列挙します。

* 一文字の変数名 (例: `a`, `b`, `c`)
* 何も考えていない (例: `abc`, `xyz`)
* 理由もなく連番が入っている (例: `test001`, `method1`)
* 作者の名前が入ってしまっている (例: `matumotoFlg`)
* まったく関係のない名前 (例: `kaeru`)

::div{.note title="ノート"}

例外はもちろんあります。
以下のような変数は1文字からなる変数ですが、それ自身が意味を持つのでそのまま使ってもかまいせん。
しかし、もし長い変数名が許されるなら、修飾を付け加えることを推奨します。

* 座標をあらわす: `x`, `y`, `z`, `r`
* インデックス: `i`, `j`, `k`

::

### <i class="fa-solid fa-dog"></i> 羊頭狗肉

下のような関数を見たとき、この関数は何をしてくれそうでしょうか。
もちろんファイルに何かを書いてくれそうですよね。

```typescript
function writeFile(fileName: string): void{
    // ....
}
```

でも関数のインタフェースをよく見てください。
書き込むべき内容を表す変数がありません。
したがって、この関数はファイルにデータを書き込む関数ではなかったようです。
実際は、ファイルの内容をコンソールに出力する関数でした。
羊の頭(ファイルに書き込み)で狗の肉(画面に出力する)を提供している関数でした。

この事例は、筆者のプログラマ経験で実際あった話です。
このように、関数名は名前からその機能を想像できるように名づけるべきです。

### <i class="fa-solid fa-battery-empty"></i> 形骸化したプロジェクト基準

企業が開発するような大規模なプロジェクトの場合、プロジェクトメンバや後の開発者がルールを守れるように **コーディング基準書** を作成することがあります。
この基準書は、ソースコードの読みやすさに直接的に影響を及ぼすため、ソースコードとともに運用されるべきです。

```markdown
## ローカル変数

* camelCaseで宣言すること
* クラスローカルで `private` な変数はアンダースコア(`_`)で始めること
* `boolean`変数は以下のいづれかで始めること
  * `is`, `can`, `has`
... 
```

しかしながら、大規模なプロジェクトになればなるほど、基準書は追加されていき、基準書を読むだけで2～3日かかってしまうボリュームになってしまうことがあります。
こうなると、基準書はどんどん形骸化していき使われない基準が増えていってしまいます。
定期的に基準を見直すようにしましょう。

::div{.info title="ヒント"}

近年はツールが高度化、高速化しているため、基準書に記述された基準の多くはリアルタイムに指摘し、修正を促すツールが増えました。
[Prettier](https://prettier.io/)
や
[eslint](https://eslint.org/)
、
[EditorConfig](https://spec.editorconfig.org/)
です。
これらのツールを最大限に運用し、基準書を可能な限り軽量にすることも検討してください。

さらに、GitHub CopilotなどのAIコーディングアシスタントでは、
[instructions](https://docs.github.com/en/copilot/customizing-copilot/adding-repository-custom-instructions-for-github-copilot)
のような機能が有用です。

::

### <i class="fa-solid fa-person-cane"></i> 老朽化したハンガリアン記法

```cpp
char_t* pszGreeting = "Hello World.";
DWORD dwUnexpectedError = 0x8000FFFF;
```

ハンガリアン記法 (Hungarian notation) とは、主に変数名に特別な接頭文字や接尾文字をつける表記法のひとつです。
他の人がその変数名を見たときに、使用方法、データ型情報などが分かるようにするための命名法です。

考案者である、チャールズ・シモニーがハンガリー出身なので、このような呼ばれ方をします。

ただし、近年のプログラミングの慣習ではあまり使われることはありません。
近年は統合開発環境が整備さたので、開発環境上で変数の情報をマウスをホバーするだけで、変数の型や宣言を見られるようになりました。
Java, C#,TypeScript, Python といった高級なプログラミング言語から入門したプログラマはそもそも存在すら知らないです。
そのため、新規でコードを書く場合、　**特に事情がない限りハンガリアン記法を使うべきではありません。**

ところが、レガシーシステムをメンテナンスする場合、このようなコードが残っている可能性が高いです。
このような場合、ハンガリアン記法を無視してコードを記述すると、後の保守者は他コードと並べて見ることになります。
そして、彼はいうはずです。

「なんでここだけスタイル違うの？気になって読めないよ。」

既存コードがハンガリアン記法で記述されていた場合、**十分ハンガリアン記法を学習して周りのコードとの違和感を出さない努力をすべきです。**

## 命名規則で最低限決めておけばいいこと

それでは、命名規則を考えるうえで最低限決めておくことを記載します。
近年は統合開発環境や静的解析ツールが整備されているので、ここに記述した内容の一部は、編集中に指摘してくれます。

### 大文字/小文字

変数名や関数名の大文字や小文字は決まった法則性にしたがって記述しておくと、全体の統一感が出て読みやすくなります。
大文字/小文字のルールは慣習にしたがって、`camelCase`, `PascalCase`のように呼ばれます。
それぞれどのように書くかを下の表にまとめました。

| 形式名       | 説明                                                                 | サンプル                    |
| ------------ | -------------------------------------------------------------------- | --------------------------- |
| `camelCase`  | 一単語目だけをすべて小文字で書き、残りの単語の先頭文字を大文字で書く | `readFile()`,  `fileName`   |
| `PascalCase` | 単語の先頭を大文字で書き、残りをすべて小文字で書く                   | `ReadFile()`,  `FileName`   |
| `snake_case` | 単語はすべて小文字で書いて、区切りをアンダースコアで記述する         | `read_file()`,  `file_name` |
| `UPPER_CASE` | 単語はすべて小文字で書いて、区切りをアンダースコアで記述する         | `READ_FILE()`, `FILE_NAME`  |

これらのケースは言語やフレームワークによって暗黙のルールがあります。
このルールにしたがわないと、自分が定義した関数や変数うだけルールがしたがっていないため、そこに違和感が生まれます。

以下に代表的な開発言語と、大文字小文字ルールについてまとめました。

| 言語名                | 型やクラス名 | 変数        | 関数/メソッド | 定数         |
| --------------------- | ------------ | ----------- | ------------- | ------------ |
| JavaScript/TypeScript | `PascalCase` | `camelCase` | `camelCase`   | `camelCase`  |
| Java                  | `PascalCase` | `camelCase` | `camelCase`   | `camelCase`  |
| C#                    | `PascalCase` | `camelCase` | `PascalCase`  | `UPPER_CASE` |

必ず、従う必要はないですが、したがっておいたほうが読みやすくなります。
事前にどうするかを決めておきましょう。

### 動詞/名詞

慣習上、メソッドや関数は動詞で始まるようにして、プロパティや変数は名詞で名づけます。
こうすることで、ソースコードはまるで英文を読んでいるかのように読みやすくなります。

```javascript
const reader = new InputReader(input);
const fileWriter = new FileWriter(fileName);

while(!reader.isEof) {
    const line = await reader.readLine();
    await fileWriter.writeLine(line);
}
```

もちろん例外はあります。
例えば、文字列化をするメソッドは慣習上 `toString()` と動詞ではなく前置詞で始まります。
イベントを表す `on*()` も前置詞で始めます。

::div{.info title="ヒント"}

筆者はこの問題に対して、JavaScriptおよびTypeScriptに対応した
[ESLint](https://eslint.org/)
のプラグインを開発中です。
メソッドや関数が **よく知られた動詞** で始まることを強制するためのプラグインとして設計しています。

<i class="fa-brands fa-square-github"></i>
[kazumatu981/eslint-plugin-verb-method-name](https://github.com/kazumatu981/eslint-plugin-verb-method-name)

::

### 接頭語/接尾語

接頭語や接尾語を決めておくことで、コードに統一感が出てさらに読みやすくなります。
命名規則としてはかなり高度であるため、このドキュメントでは詳しくは解説しませんが、下記のような規則を設けることがあります。

* `interface` は `I` からはじめる。
* `abstract` なクラスは `Base`で終わる。
* `private`なメンバは `_`からはじめる。
* `static` なメンバは `s`からはじめる。
* `global` な変数は `g` からはじめる。
* そのメソッドで参照しないパラメタは `_` からはじめる。

もっとも重要なことは、これらのルールは一部分に適用するのではなく、プロジェクト全体に適用することです。
こうすることで、全体としてソースコードの統一感出てきて、読みやすくなります。
部分的に適用するなら、最初から適用しないほうが賢明です。

## 命名に迷ったら生成AIも活用しよう

2025年現在、生成AIのプログラミング開発環境への浸透が急速に進んでいます。
残念ながら、生成AIで自然言語だけで開発が進むいわゆる Vibe Coding の世界は実現できていません。
そこで、プロンプトで支援してもらいながら、コーディングを進めていくのが現実解です。

ここでは、生成AIを使って命名規則に関するプロンプトをいくつか紹介します。

### 事例：統合開発環境のAI機能を使って提案してもらう

以下の事例は、GitHub Copilot をAgentモードで動作をさせて、メソッド名を変更してもらう例です。

```typescript
/**
 * 次の字句を読み込み、トークンとして返します。
 * 空白をスキップし、現在の文字が数字、演算子、または括弧の場合に対応するトークンを切り出します。
 * 入力文字列の末尾に達している場合、または空白のみの場合は未定義を返します。
 * 予期しない文字が現れた場合は例外をスローします。
 * @returns 切り出されたトークン、または未定義
 * @throws TokenizerError - 予期しない文字が検出された場合
 */
public someMethod(): Token | undefined {
    // ....
}
```

メソッドの実装がほぼ完了しており、メソッドの役割がヘッダコメントとして書かれていた場合、生成AIは精度よくメソッド名を決定してくれます。

```markdown
`someMethod()` のメソッド名が適切ではありません。
ヘッダコメントやメソッドの実装を参考にしながら、適切なメソッド名に変換してください。
ただし、メソッド名は動詞で始まる camelCaseに編集してください。
```

このように、明示的に、ヘッダコメントとメソッドの実装を参考にしながら、提案することと明示します。
また、命名規則である、メソッド名の制約(動詞で始まる、camelCaseにする)を指定するとそれに従って提案してくれます。

### 事例：プロンプトでメソッド名を提案してもらう

以下の例は、クラスのテンプレートを提案してもらう場合のプロンプトの例です。
このようにクラス使用を可能な限り明確に書くことで、しっくりくるメソッド名を提案してくれます。

```markdown
## 前提

わたしは、現在 `<クラス名>` 言語で、ライブラリを開発しています。
`<className>` という名前のクラスを実装しています。
このクラスの役割は以下の通りです。
* `<クラスの機能1>`
* `<クラスの機能2>`
* `<クラスの機能3>`
これらの機能のうち `<クラスの機能2>` を実現するメソッドの `<処理名>` を実現するために、
機能概要で示す機能を持つメソッドの名前を検討しています。

## 機能概要

`<ここに機能概要を完結に書いてください>`

## 条件

* メソッド名は英語で提案してください。
* `<camelCase | PascalCase のどちらか>` で提案してください。
* メソッド名は動詞で開始してください。
* わかりやすくするために2単語以上で構成するようにしてください。

## やってほしいこと

「前提」、「機能概要」を読んで「条件」に基づいて5個メソッド名を提案してください。
また、それぞれの提案にはなぜその名前にしたのかの理由もつけてください。
```
