# 空白とコメント

## 空白は美しさを生み出す

アートでは余白の使い方ひとつで作品の印象が大きく変わります。
例えば、日本の伝統的な水墨画では、紙の白い部分を意図的に残すことで、余韻や空間の広がりを表現することがあります。

::: tabs

@tab 空白なし

![龍](../../assets/img/dragon.png)

@tab 空白あり

![龍-空白](../../assets/img/dragon-with-ws.png)

:::

「ホワイトスペース」を活用することで、情報をすっきりと整理し、視線の流れを誘導します。

これはソースコードにも共通する考え方です。
適切な空白を使うことで、可読性が向上し、コードの構造が明確になります。まずは、以下のコードを見てください。

```javascript
function calc(a,b){return a+b;}
let result=calc(5,10);
console.log(result);
```

コンパクトにまとまっていますが、全体的に詰まっています。
コードが読みづらく、問題が発生した場合、その原因を見つけるのも困難になります。

```javascript
function calculate(a, b) {
    return a + b;
}

let result = calculate(5, 10);

console.log(result);
```

そこで、このように適切な改行を入れ、論理的な「かたまり」ごとに整理をしてみました。
随分読みやすくなりましたね。

```javascript
function processData(data) {
    if (data.length > 0) {
        data.forEach(item => {
            console.log(`Item: ${item}`);
        });
    } else {
        console.log("No data available.");
    }
}

let sampleData = ["apple", "banana", "cherry"];

processData(sampleData);
```

さらに構造が複雑になると、インデントや関数、ラムダ式等、構文的な「かたまり」を意識することでかなり読みやすくなります。

空白は単なる「スペース」ではなく、情報を整理し、プログラムの意図を明確に伝える重要な要素です。
ソースコードでもアートと同じように「余白の美学」を意識することで、読みやすく、理解しやすいコードを書くことができますね。

## 空白を使用するときのポイント

空白を意識することで、コードの可読性が大幅に向上します。以下に、特に注意すべき「空白のポイント」を整理しました。
空白を適切に活用することで、コードはより読みやすく、理解しやすくなります。特に以下のポイントに注意すると、可読性が向上します。

::labeled-container-with-fa-icon{type="success" label="空白のポイント"}

1. **関数宣言の前後**: 他のコードと区別を明確にする。
2. **演算子の前後**: 計算式の視認性を高める。
3. **`if` 文の前後**: 条件式と処理をスムーズに読めるようにする。
4. **インデント**: コードの階層構造を明確にする。
5. **空行**: コードのまとまりを適切に区切る。

::

### 関数宣言の前後

関数宣言の前後に適切な空白を入れることで、コードの構造がより明確になります。
他のコードとの区別がしやすくなり、どこから関数の定義が始まるのかが視覚的に分かりやすくなります。

::: tabs

@tab 悪い例

```javascript
const add=function(a,b){return a+b;}
```

@tab 良い例

```javascript
const add = function(a, b) {
    return a + b;
};
```

:::

### 演算子の前後

演算子 (`+`, `-`, `*`, `/` など) の前後に空白を入れることで、式の構造が視認しやすくなります。

::: tabs

@tab 悪い例

```javascript
let total=price*quantity+tax;
```

@tab 良い例

```javascript
let total = price * quantity + tax;
```

:::

### `if`や`while` 文の前後

`if` や `while` 文の前後に空白を入れることで、条件式とその処理がスムーズに読めるようになります。
条件式やブロックの `{}` の前後に適切な空白を入れることで、コードの意図が明確になります。

::: tabs

@tab  悪い例

```javascript
if(x>0){console.log("Positive");}
```

@tab 良い例

```javascript
if (x > 0) {
    console.log("Positive");
}
```

:::

### インデント（字下げ）

インデントを使用して、コードの階層関係を視覚的に明示することで、構造を理解しやすくなります。
インデントを使用することで、どの部分が `if` の条件に依存しているのかが明確になります。

::: tabs

@tab 悪い例:

```javascript
function processData(data){
if(data.length>0){
data.forEach(item=>{
console.log(`Item: ${item}`);
});
}else{
console.log("No data available.");
}
}
```

@tab 良い例:

```javascript
function processData(data) {
    if (data.length > 0) {
        data.forEach(item => {
            console.log(`Item: ${item}`);
        });
    } else {
        console.log("No data available.");
    }
}
```

:::

### 空行の活用

関連するコードのグループを適度に区切ることで、コードの見通しが良くなります。
関係するコードの塊ごとに適度な空行を入れることで、処理の流れを直感的に把握しやすくなります。

::: tabs

@tab 悪い例

```javascript
function fetchData() {
    console.log("Fetching data...");
    let data = ["apple", "banana", "cherry"];
    data.forEach(item => {
        console.log(item);
    });
    console.log("Done.");
}
```

@tab 良い例

```javascript
function fetchData() {
    console.log("Fetching data...");

    let data = ["apple", "banana", "cherry"];
    
    data.forEach(item => {
        console.log(item);
    });

    console.log("Done.");
}
```

:::

## コメントの半分は「やさしさ」でできています

ソースコードを書くとき、書き手には設計思想を読み手に伝えるという大切な使命があります。
もちろん、コードそのものにも設計思想を反映させることはできますが、それだけでは十分に意図が伝わらないこともあります。そこで登場するのがコメントです。
コメントには、コードだけでは表現しきれない「書き手の思い」を込めることができます。

* なぜこの処理が必要なのか、
* どういう背景でこの設計が選ばれたのか、
* バグ回避のために施した工夫

このような事柄をコメントに残すことで、読み手はコードをよりスムーズに理解できるのです。
まさに、書き手の読み手に対する「やさしさ」ですね。

さらに、コードから読み取れる情報であっても、簡単な補足を加えるだけでグッと読みやすくなることもあります。

* `https://...` を参照すること
* 設計書「〇〇〇〇」を参照すること
* これは〇〇の公式を応用した

とひと言添えるだけで、読み手は迷わずコードの意図をつかめます。
こうしたちょっとした気配りこそが、読み手に対する「やさしさ」の表れなのです。

しかし、ここで注意したいのが「やさしさのバランス」。
世の中には「有難迷惑」や「おせっかいが過ぎる」という言葉がありますが、コメントにも同じことが言えます。

* `a = b + 1 // 変数 a に b を 1 加えています`
* `add(a, b); // a と b を足す`
* `throw new Error(); // 例外が発生`

このようなコメントは、ほぼコードをそのまま説明しているだけで、かえって冗長になってしまいます。
適切なコメントは、読み手の負担を軽減しますが、過剰なコメントは逆に混乱を招くこともあるのです。
「やさしさ」には「ちょうどいい塩梅」が大切です。
心地よいバランスを保ちつつ、読み手に優しいコードを目指しましょう。

## コメントを使用するときのポイント

それでは、読み手に「やさしく」そして「ちょうどいい塩梅」のコメントはどんなコメントでしょう。
以下に「コメントのポイント」をまとめました。

::labeled-container-with-fa-icon{type="success" label="コメントのポイント"}

1. ブロックコメントとインラインコメント
2. 必要な情報のみを記述する
3. 最新の状態に保つ
4. コードの意図を説明する
5. 一貫性を持たせる
6. 適切な場所に記述する

::

### ブロックコメントとインラインコメント

#### ブロックコメント

ブロックコメントは、複数行にわたる説明や、関数やクラスの概要を説明する際に使用します。主に詳細な情報を残したい場合に有効です。

```javascript
/**
 * 商品の割引価格を計算する関数
 * @param {number} price - 元の価格
 * @param {number} discount - 割引率（0.1 なら 10%）
 * @returns {number} 割引後の価格
 */
function applyDiscount(price, discount) {
    return price - (price * discount);
}
```

* 適切な使い方:
  * 関数やクラスの説明を書くとき
  * 重要なロジックの背景や理由を記述するとき
  * 長めの補足情報が必要なとき
* 避けるべき使い方:
  * 単なるインラインコメントの代わりに使わない
  * 不必要に長すぎる説明を避ける
  * 古いコメントが残り続けないように、更新する

#### インラインコメント

インラインコメントは、コードの特定の部分について、簡潔に説明するために使用します。
主に短い補足説明を記述する際に利用されます。

```javascript
 // 「初夏セール」の割引率 (10%)
const earlySumerSaleDiscountRate = 0.1;

function calcEarlySumerDiscount(price) {
    // 割引を適用した最終価格
    return (1-earlySumerSaleDiscountRate) * price;
}
```

* 適切な使い方
  * 局所的な説明が必要な場合
  * 短いコメントで済む場合
  * コードの右側に記述し、行の長さが過度に長くならないようにする
* 避けるべき使い方
  * 長い文章の説明をインラインで書かない
  * ほとんど自明なことを冗長に説明しない
  * 多すぎるインラインコメントでコードを読みづらくしない

### 必要な情報のみを記述する

コメントはコードの補助的な情報として機能します。コードの内容を冗長に説明するのではなく、何を意図しているのかを簡潔に伝えることが重要です。

:::tabs

@tab 悪い例

```javascript
// このループは 0 から 9 までの数値を出力します
for (let i = 0; i < 10; i++) {
    console.log(i);
}
```

@tab 良い例

```javascript
// 0 から 9 までの数値をログに出力
for (let i = 0; i < 10; i++) {
    console.log(i);
}
```

:::

### 最新の状態に保つ

プログラムのコメントは、コードの動作を補足する役割を持ちます。
しかし、コメント自体はプログラムの動作には直接影響を及ぼさないため、更新が放置されることも少なくありません。
その結果、コメントに書かれた内容と実際の動作が異なり、後からコードをメンテナンスする開発者が混乱する事態を招きます。
以下に例を挙げます。

#### コードコメントのメンテナンスを怠るとどうなるか

```python
# ユーザーリストを取得（管理者のみ）
def get_user_list():
    return fetch_all_users()  # 実際には全ユーザーを取得
```

このコメントを見ると、「管理者のみのユーザーリストを取得する」関数のように見えます。
しかし、実際のコードは すべてのユーザー を取得する実装になっています。このようなコメントの誤りは、後からコードを読む人に誤解を与え、バグを引き起こす可能性があります。

#### コメントもコードと同じくメンテナンスが必要

コードの変更に伴い、コメントも適切に更新することが求められます。
メンテナンスされたコメントは、コードの意図を的確に伝え、スムーズな保守作業を可能にします。
すなわち、下記のようにコメントも修正しましょう。

```python
# すべてのユーザーリストを取得
def get_user_list():
    return fetch_all_users()
```

#### コードの意図を説明する

「コードの動作」ではなく「コードの目的」や「なぜこの処理が必要なのか」を説明すると、他の開発者がコードの意図を理解しやすくなります。

:::tabs

@tab 悪い例

```javascript
// 文字列を大文字に変換する
let upperCaseName = name.toUpperCase();
```

@tab 良い例

```javascript
// ユーザー入力を統一するために大文字へ変換
let upperCaseName = name.toUpperCase();
```

:::

#### 一貫性を持たせる

プロジェクト内でコメントの書き方を統一することで、コード全体の可読性が向上します。スタイルガイドを設定し、一定のルールを守るようにします。

:::tabs

@tab 悪い例

``` javascript
// Incrementing counter
count++; // カウントを増やす
```

@tab 良い例

```javascript
// カウントを1増やす
count++;
```

:::

#### 適切な場所に記述する

コメントは該当するコードの近くに配置し、コードが読みやすくなるように心がけましょう。関数の説明は関数の上部に記述し、処理の意図を伝えます。

:::tabs

@tab 悪い例

```javascript
function add(a, b) {
    return a + b; // ここで2つの値を足し算する
}
```

@tab 良い例

```javascript

/**
 * 二つの数値を足し算する
 * @param {number} a - 数値(ひとつ目)
 * @param {number} b - 数値(二つ目)
 * @returns 計算結果
 */
function add(a, b) {
    return a + b;
}

:::
