# 「よみやすさ」とは

## :rocket: はじめに

TODO ここに、モチベーション書く

* 困ったことはないか
* 事例をいくつか列挙する

## :dart: 目的: 人にやさしく

### プログラミング言語の存在意義

なぜソースコードを読みやすくするのでしょうか？
それを知るためには、そもそもプログラミング言語がなぜ生まれたかについて知る必要があります。

コンピュータは計算機です。
計算の手順を記述したものがプログラムです。
皆様が `Windows` をお使いの場合、拡張子が　`.exe`や `.dll` となっているものを見かけたことがあるはずです。
それが **プログラム** です。

ファイルの中身を見るとわかるのですが、人間にとってはただのデータの塊です。
少し勉強をするとわかるのですが、このデータは特定のルールに従って並んでおり、その意味を知れば読めるらしいのです。
コンピュータはこの形でしか理解できません(これを **機械語** と呼びます)。
少なくとも筆者にとってはとても読みづらし、書きづらいです。

コンピュータは機械語しか理解できず、人間の自然な言葉では動作しません。
この問題を解決するために、人間にわかりやすい命令方法（言葉）と、それを翻訳するプログラムが開発されました。
それが プログラミング言語 と コンパイラ です。
つまり、プログラミング言語 が人間にとって理解しづらいものになってしまうことは、その存在意義と大きく矛盾します。
だからこそ、ソースコードはわかりやすく書くことが大切です。
コードを整えることで、読みやすくなり、誰が見ても理解しやすくなります。

### 他人に読みやすく

ソースコードを読みやすくすることの重要性を解説しましたが、それは誰にとってでしょうか？
誰のことか想像してみてください。

複数人で開発した経験がある人は、他のチームメンバが書いたソースコードを読みづらく感じた経験があるかもしれません。
個人で開発している人も、いくつかプロジェクトをこなしていくと、過去のプロジェクトで書いたソースコードを振り返ってみると、
「あれ？これ何だっけ？」となってしまうこともあります。

ここで大切なことは、**他人に** と書きましたが、**過去の自分も、もはや他人**になってしまうということです。
「個人開発なので、自分は大丈夫だ」と思っていても、不具合対応や機能拡張を行うとしたときに、過去に作りこんだ難読性が牙をむくのです。

## :globe_with_meridians: 大前提: 普遍性はない

そもそもソースコードの読みやすさってなんでしょう？
読みやすいというのは、もちろん主観的であり、感覚的なものです。
定量的に測れるものではありません。
したがって、普遍的な読みやすさというものがあるわけではないということを大前提にしてもらいたいです。

例えば、下記のようなコードがあったと仮定します。

```cpp
while ( flg1 )
{
    // ...
    if ( flg2 )
    {
        flg1 = false;
    }
}
```

このようなソースコードは `flg1` や `flg2` が何を指すための変数なのかわかりにくいので、読みやすくするために、「名は体を表す変数名」にすることが推奨されています。

```cpp
while ( !isBlocked )
{
    // ...
    if ( isCalled )
    {
        isBlocked = true;
    }
}
```

さらに、英単語 `Block` が否定的な意味を持っており、否定演算子 `!` と共存しているため、**二重否定** になっています。
*教科書どおり* にいうと、**読みにくいソースコード** と言われています。
したがって、以下のようなソースコードにすべきだといわれています。

```cpp
while ( mustBeContinue )
{
    // ...
    if ( isCalled )
    {
        mustBeContinue = false;
    }
}
```

読者の皆様はいかが感じたでしょうか？

大多数の読者は最後の例が一番読みやすいと感じたかもしれません。
参考文献に挙げたような教科書的にはそれが正解です。

しかしながら、残念ながら、場合によって最後の例が一番読みにくく感じる場合もあるのです。
現在のソフトウェア開発では複数人で開発することがほとんどです。
過去に誰かが開発したソフトウェアをメンテナンスすることもあります。

![違和感](../assets//img/iwakan.drawio.svg)

ソースコード全体を見渡したときに、今回の箇所だけが、「名は体を表す変数名」なっていた場合、その部分だけが「違和感」「異物感」が出てしまうのです。

このように読みやすさの根底には、「違和感」や「異物感」を生まない **統一性** を出すことがあります。

## :question: What shall we do?

> 技術的な努力と感性的な努力のたまものです

前節で、読みやすさの根底には、「異物感」を生まない **統一性** が必要であることを述べました。
それでは、何に対して **統一性** を持たせればいいのでしょう？
筆者は **技術的な努力** と **感性的な努力** の両面が必要だと考えています。

![読みやすさの構造](../assets//img/description_of_readable.drawio.svg)

**技術的な努力** とは、空白の使い方や変数や関数の命名方法、コメント記述方法といったソースコードの動作とは関係ない**編集的な努力** と、モジュール構成、階層化、カプセル化といったプログラミング設計にかかわる **構造的な努力** からなります。
この **技術的な努力** については、多くの参考文献が出版されており、技術系ブログでも多く解説されています。

本書でこだわりたいのはもう1つの **感性的な努力** です。
ソースコードは、先に述べたとおり、**機械が読む** ものである一方で、 **人間が読む** ためでもあります。
したがって、読みやすいソースコードを書くことは、読みやすい文を書くことに似ています。
読みやすいソースコードを書くためには、**ストーリ性** と、なにより他人に読んでもらいたいという **思いやり** が重要になってきます。

## :checkered_flag: 目標

> 読みやすさを実現するための「がんばりポイント」について気づきを得る

このように本書では、読みやすいソースコードを記述するために、**感性的な** 側面と **技術的な** 側面の両面から考察します。

筆者は、プログラマ経験で多くの技術者と出会ってきました。
その中でも仲間内から、「XXさんの記述したコードは読みやすいよね」といわれていた技術者に共通することは何かを考えさせられてきました。
感性的な側面から、筆者が思うソースコードを読みやすくするためのマインドセットについて記述します。

技術的な側面は、筆者がかかわった多くのプロジェクトが運用いるコーディングルールをもとに、どのような要素で読みやすさを実現しようとしているのかについて解説します。
さらに、読みやすいソースコードは *well-designed(よく設計された状態)* です。
どのような点に注意すれば、*well-designed* になるのかを説明します。

最後に、年々優秀になっていくIDEのソースコードリコメンデーション機能と読みやすさの関係について考え、リコメンデーション機能との付き合い方について持論を展開します。
